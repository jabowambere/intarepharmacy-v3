{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\coding.PROGR-PC4\\\\Documents\\\\intarepharmacy-v2\\\\pharmacy-frontend\\\\src\\\\context\\\\AuthContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useState, useEffect } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/createContext();\nexport const useAuth = () => {\n  _s();\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n};\n_s(useAuth, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nexport const AuthProvider = ({\n  children\n}) => {\n  _s2();\n  const [user, setUser] = useState(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [medicines, setMedicines] = useState([]);\n  const [pharmacists, setPharmacists] = useState(() => {\n    const saved = localStorage.getItem('pharmacists');\n    return saved ? JSON.parse(saved) : [{\n      id: 1,\n      name: 'Dr. Sarah Johnson',\n      email: 'sarah@pharmacy.com',\n      phone: '555-0101',\n      license: 'PH-12345'\n    }, {\n      id: 2,\n      name: 'Dr. Michael Chen',\n      email: 'michael@pharmacy.com',\n      phone: '555-0102',\n      license: 'PH-12346'\n    }];\n  });\n  const [orders, setOrders] = useState(() => {\n    const saved = localStorage.getItem('orders');\n    return saved ? JSON.parse(saved) : [];\n  });\n\n  // Initialize user and fetch medicines\n  useEffect(() => {\n    const savedUser = localStorage.getItem('user');\n    const token = localStorage.getItem('token');\n    if (savedUser && token) {\n      setUser(JSON.parse(savedUser));\n    }\n    setIsLoading(false);\n    fetchMedicines();\n  }, []);\n\n  // Save pharmacists to localStorage whenever they change\n  useEffect(() => {\n    localStorage.setItem('pharmacists', JSON.stringify(pharmacists));\n  }, [pharmacists]);\n\n  // Save orders to localStorage whenever they change\n  useEffect(() => {\n    localStorage.setItem('orders', JSON.stringify(orders));\n  }, [orders]);\n  const login = async (email, password, role) => {\n    const normalizedEmail = email === null || email === void 0 ? void 0 : email.trim().toLowerCase();\n    const apiUrl = process.env.REACT_APP_BACKEND_URL || 'http://localhost:5000';\n    try {\n      const res = await fetch(`${apiUrl}/api/auth/login`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          email: normalizedEmail,\n          password,\n          role\n        })\n      });\n      const data = await res.json();\n      if (res.ok) {\n        setUser(data.user);\n        localStorage.setItem('user', JSON.stringify(data.user));\n        localStorage.setItem('token', data.token);\n        return true;\n      }\n      return false;\n    } catch (err) {\n      console.error('Backend not available, using fallback login:', err);\n      // Fallback to local authentication\n      let userData = null;\n      if (role === 'admin' && normalizedEmail === 'admin@pharmacy.com' && password === 'compwizard') {\n        userData = {\n          id: 'admin',\n          email: normalizedEmail,\n          role: 'admin',\n          name: 'Admin User'\n        };\n      } else if (role === 'pharmacist' && password === 'pharmacist123') {\n        const pharmacist = pharmacists.find(p => p.email.toLowerCase() === normalizedEmail);\n        if (pharmacist) {\n          userData = {\n            id: pharmacist.id,\n            email: normalizedEmail,\n            role: 'pharmacist',\n            name: pharmacist.name\n          };\n        }\n      }\n      if (userData) {\n        setUser(userData);\n        localStorage.setItem('user', JSON.stringify(userData));\n        localStorage.setItem('token', 'fallback-token');\n        return true;\n      }\n      return false;\n    }\n  };\n  const logout = () => {\n    setUser(null);\n    localStorage.removeItem('user');\n    localStorage.removeItem('token');\n  };\n  const fetchMedicines = async () => {\n    try {\n      const apiUrl = process.env.REACT_APP_BACKEND_URL || 'http://localhost:5000';\n      const res = await fetch(`${apiUrl}/api/medicines`);\n      const data = await res.json();\n      const formattedMedicines = data.map(med => ({\n        id: med._id,\n        name: med.name,\n        description: med.description,\n        price: med.price,\n        stock: med.quantity,\n        category: med.category,\n        image: med.image\n      }));\n      setMedicines(formattedMedicines);\n    } catch (error) {\n      console.error('Error fetching medicines:', error);\n    }\n  };\n  const getStockAlerts = () => {\n    return medicines.filter(medicine => medicine.stock < 20);\n  };\n  const value = {\n    user,\n    isLoading,\n    login,\n    logout,\n    medicines,\n    setMedicines,\n    fetchMedicines,\n    pharmacists,\n    setPharmacists,\n    orders,\n    setOrders,\n    getStockAlerts\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 140,\n    columnNumber: 10\n  }, this);\n};\n_s2(AuthProvider, \"IVgG71V7j1nZRf9Ihx4cOk/hz00=\");\n_c = AuthProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","jsxDEV","_jsxDEV","AuthContext","useAuth","_s","context","Error","AuthProvider","children","_s2","user","setUser","isLoading","setIsLoading","medicines","setMedicines","pharmacists","setPharmacists","saved","localStorage","getItem","JSON","parse","id","name","email","phone","license","orders","setOrders","savedUser","token","fetchMedicines","setItem","stringify","login","password","role","normalizedEmail","trim","toLowerCase","apiUrl","process","env","REACT_APP_BACKEND_URL","res","fetch","method","headers","body","data","json","ok","err","console","error","userData","pharmacist","find","p","logout","removeItem","formattedMedicines","map","med","_id","description","price","stock","quantity","category","image","getStockAlerts","filter","medicine","value","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/coding.PROGR-PC4/Documents/intarepharmacy-v2/pharmacy-frontend/src/context/AuthContext.js"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from 'react';\r\n\r\nconst AuthContext = createContext();\r\n\r\nexport const useAuth = () => {\r\n  const context = useContext(AuthContext);\r\n  if (!context) {\r\n    throw new Error('useAuth must be used within an AuthProvider');\r\n  }\r\n  return context;\r\n};\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n  const [user, setUser] = useState(null);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [medicines, setMedicines] = useState([]);\r\n  const [pharmacists, setPharmacists] = useState(() => {\r\n    const saved = localStorage.getItem('pharmacists');\r\n    return saved ? JSON.parse(saved) : [\r\n      { id: 1, name: 'Dr. Sarah Johnson', email: 'sarah@pharmacy.com', phone: '555-0101', license: 'PH-12345' },\r\n      { id: 2, name: 'Dr. Michael Chen', email: 'michael@pharmacy.com', phone: '555-0102', license: 'PH-12346' },\r\n    ];\r\n  });\r\n  const [orders, setOrders] = useState(() => {\r\n    const saved = localStorage.getItem('orders');\r\n    return saved ? JSON.parse(saved) : [];\r\n  });\r\n\r\n  // Initialize user and fetch medicines\r\n  useEffect(() => {\r\n    const savedUser = localStorage.getItem('user');\r\n    const token = localStorage.getItem('token');\r\n    \r\n    if (savedUser && token) {\r\n      setUser(JSON.parse(savedUser));\r\n    }\r\n    setIsLoading(false);\r\n    fetchMedicines();\r\n  }, []);\r\n\r\n\r\n\r\n  // Save pharmacists to localStorage whenever they change\r\n  useEffect(() => {\r\n    localStorage.setItem('pharmacists', JSON.stringify(pharmacists));\r\n  }, [pharmacists]);\r\n\r\n  // Save orders to localStorage whenever they change\r\n  useEffect(() => {\r\n    localStorage.setItem('orders', JSON.stringify(orders));\r\n  }, [orders]);\r\n\r\n  const login = async (email, password, role) => {\r\n    const normalizedEmail = email?.trim().toLowerCase();\r\n    const apiUrl = process.env.REACT_APP_BACKEND_URL || 'http://localhost:5000';\r\n\r\n    try {\r\n      const res = await fetch(`${apiUrl}/api/auth/login`, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ email: normalizedEmail, password, role }),\r\n      });\r\n      const data = await res.json();\r\n      if (res.ok) {\r\n        setUser(data.user);\r\n        localStorage.setItem('user', JSON.stringify(data.user));\r\n        localStorage.setItem('token', data.token);\r\n        return true;\r\n      }\r\n      return false;\r\n    } catch (err) {\r\n      console.error('Backend not available, using fallback login:', err);\r\n      // Fallback to local authentication\r\n      let userData = null;\r\n      \r\n      if (role === 'admin' && normalizedEmail === 'admin@pharmacy.com' && password === 'compwizard') {\r\n        userData = { id: 'admin', email: normalizedEmail, role: 'admin', name: 'Admin User' };\r\n      } else if (role === 'pharmacist' && password === 'pharmacist123') {\r\n        const pharmacist = pharmacists.find(p => p.email.toLowerCase() === normalizedEmail);\r\n        if (pharmacist) {\r\n          userData = { id: pharmacist.id, email: normalizedEmail, role: 'pharmacist', name: pharmacist.name };\r\n        }\r\n      }\r\n      \r\n      if (userData) {\r\n        setUser(userData);\r\n        localStorage.setItem('user', JSON.stringify(userData));\r\n        localStorage.setItem('token', 'fallback-token');\r\n        return true;\r\n      }\r\n      return false;\r\n    }\r\n  };\r\n\r\n  const logout = () => {\r\n    setUser(null);\r\n    localStorage.removeItem('user');\r\n    localStorage.removeItem('token');\r\n  };\r\n\r\n  const fetchMedicines = async () => {\r\n    try {\r\n      const apiUrl = process.env.REACT_APP_BACKEND_URL || 'http://localhost:5000';\r\n      const res = await fetch(`${apiUrl}/api/medicines`);\r\n      const data = await res.json();\r\n      const formattedMedicines = data.map(med => ({\r\n        id: med._id,\r\n        name: med.name,\r\n        description: med.description,\r\n        price: med.price,\r\n        stock: med.quantity,\r\n        category: med.category,\r\n        image: med.image\r\n      }));\r\n      setMedicines(formattedMedicines);\r\n    } catch (error) {\r\n      console.error('Error fetching medicines:', error);\r\n    }\r\n  };\r\n\r\n  const getStockAlerts = () => {\r\n    return medicines.filter(medicine => medicine.stock < 20);\r\n  };\r\n\r\n  const value = {\r\n    user,\r\n    isLoading,\r\n    login,\r\n    logout,\r\n    medicines,\r\n    setMedicines,\r\n    fetchMedicines,\r\n    pharmacists,\r\n    setPharmacists,\r\n    orders,\r\n    setOrders,\r\n    getStockAlerts,\r\n  };\r\n\r\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\r\n};\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}